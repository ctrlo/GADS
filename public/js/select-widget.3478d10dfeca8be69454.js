"use strict";(self.webpackChunklinkspace=self.webpackChunklinkspace||[]).push([[732],{53163:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});n(52675),n(89463),n(2259),n(45700),n(28706),n(2008),n(50113),n(74423),n(23792),n(48598),n(62062),n(89572),n(2892),n(40875),n(26099),n(58940),n(3362),n(60825),n(21699),n(47764),n(62953);var i=n(17527),a=n(11977),r=n(56197),o=n(74692);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,c(i.key),i)}}function c(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}function u(e,t,n){return t=h(t),function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,d()?Reflect.construct(t,n||[],h(e).constructor):t.apply(e,n))}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(d=function(){return!!e})()}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}const p=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,t,[e])).el=o(n.element),n.$selectWidget=n.el,n.$widget=n.el.find(".form-control"),n.$trigger=n.$widget.find("[aria-expanded]"),n.$current=n.el.find(".current"),n.$available=n.el.find(".available"),n.$availableItems=n.el.find(".available .answer input"),n.$moreInfoButtons=n.el.find(".available .answer .btn-js-more-info"),n.$target=n.el.find("#"+n.$trigger.attr("aria-controls")),n.$currentItems=n.$current.find("[data-list-item]"),n.$answers=n.el.find(".answer"),n.$fakeInput=null,n.$search=n.el.find(".form-control-search"),n.lastFetchParams=null,n.multi=n.el.hasClass("multi"),n.timeout,n.required=n.el.hasClass("select-widget--required"),n.loadCounter=0,n.initSelectWidget(),n.required&&(0,r.pT)(n.el),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),i=t,(l=[{key:"initSelectWidget",value:function(){var e=this;this.updateState(),this.$widget.is("[readonly]")||(this.connect(),this.$widget.unbind("click"),this.$widget.on("click",(function(){e.handleWidgetClick()})),this.$search.unbind("blur"),this.$search.on("blur",(function(t){e.possibleCloseWidget(t)})),this.$availableItems.unbind("blur"),this.$availableItems.on("blur",(function(t){e.possibleCloseWidget(t)})),this.$moreInfoButtons.unbind("blur"),this.$moreInfoButtons.on("blur",(function(t){e.possibleCloseWidget(t)})),o(document).on("click",(function(t){e.handleDocumentClick(t)})),o(document).keyup((function(e){27==e.keyCode&&this.collapse(this.$widget,this.$trigger,this.$target)})),this.$widget.delegate(".select-widget-value__delete","click",(function(e){e.preventDefault(),e.stopPropagation();var t=e.target.parentElement.getAttribute("data-list-item"),n=document.getElementById(t);n.checked=!1,o(n).parent().trigger("click"),o(n).trigger("change")})),this.$search.unbind("focus",this.expandWidgetHandler),this.$search.on("focus",(function(t){e.expandWidgetHandler(t)})),this.$search.unbind("keydown"),this.$search.on("keydown",(function(t){e.handleKeyDown(t)})),this.$search.unbind("keyup"),this.$search.on("keyup",(function(t){e.handleKeyUp(t)})),this.$search.unbind("click"),this.$search.on("click",(function(e){e.stopPropagation()})))}},{key:"handleWidgetClick",value:function(){"true"===this.$trigger.attr("aria-expanded")?this.collapse(this.$widget,this.$trigger,this.$target):this.expand(this.$widget,this.$trigger,this.$target)}},{key:"handleDocumentClick",value:function(e){!this.el.is(e.target)&&0===this.el.has(e.target).length&&this.collapse(this.$widget,this.$trigger,this.$target)}},{key:"handleKeyUp",value:function(e){var t=o(e.target).val().toLowerCase(),n=this;if(this.$fakeInput=this.$fakeInput||o("<span>").addClass("form-control-search").css("white-space","nowrap"),this.$fakeInput.text(t),this.$search.css("width",this.$fakeInput.insertAfter(this.$search).width()+100),this.$fakeInput.detach(),"typeahead"==this.$selectWidget.data("value-selector")){var i="/".concat(this.$selectWidget.data("layout-id"),"/match/layout/").concat(this.$selectWidget.data("typeahead-id"));clearTimeout(this.timeout),this.$available.find(".spinner").removeAttr("hidden"),this.timeout=setTimeout((function(){n.$available.find(".answer").not(".answer--blank").each((function(){var e=o(this);e.find("input:checked").length||e.remove()})),n.updateJson(i+"?noempty=1&q="+t,!0)}),200)}else{var a=!1;o.each(this.$answers,(function(){-1===o(this).find("label")[0].innerHTML.toLowerCase().indexOf(t)?o(this).attr("hidden",""):(a=!0,o(this).removeAttr("hidden",""))})),a?this.$available.find(".has-noresults").attr("hidden",""):this.$available.find(".has-noresults").removeAttr("hidden","")}}},{key:"handleKeyDown",value:function(e){var t=e.which||e.keyCode;switch(this.expand(this.$widget,this.$trigger,this.$target),t){case 38:case 40:var n,i=this.$available.find(".answer:not([hidden]) input");e.preventDefault(),(n=38===t?i[i.length-1]:i[0])&&o(n).focus();break;case 13:e.preventDefault();var a=this.$available.find(".answer:not([hidden]) input").get(0);a&&o(a).parent().trigger("click")}}},{key:"expandWidgetHandler",value:function(e){e.stopPropagation(),this.expand(this.$widget,this.$trigger,this.$target)}},{key:"collapse",value:function(e,t){var n=this;this.$selectWidget.removeClass("select-widget--open"),t.attr("aria-expanded",!1),setTimeout((function(){n.$search.val(""),n.$target.attr("hidden",""),n.$answers.removeAttr("hidden")}),50)}},{key:"updateState",value:function(){var e=this.$current.children("[data-list-item]:not([hidden])");this.$current.toggleClass("empty",0===e.length)}},{key:"possibleCloseWidget",value:function(e){var t=e.relatedTarget||document.activeElement;this.$selectWidget.find(t).length||!t||o(t).is(".modal, .page, body")||this.$selectWidget.get(0).parentNode===t||this.collapse(this.$widget,this.$trigger,this.$target)}},{key:"connectMulti",value:function(){return function(){var e=o(this),t=e.data("list-item"),n=o("#"+t),i=this;n.unbind("change"),n.on("change",(function(t){o(t.target).prop("checked")?e.removeAttr("hidden"):e.attr("hidden",""),i.updateState()})),n.unbind("keydown"),n.on("keydown",(function(e){var t=e.which||e.keyCode;switch(t){case 38:case 40:var a,r=i.$answers.index(n.closest(".answer"));e.preventDefault(),(a=38===t?i.$answers[r-1]:i.$answers[r+1])&&o(a).find("input").focus();break;case 13:e.preventDefault(),o(this).trigger("click")}}))}}},{key:"connectSingle",value:function(){var e=this,t=this;this.$currentItems.each((function(n,i){var a=o(i),r=a.data("list-item"),l=o("#"+r);l.off("click"),l.on("click",(function(e){e.stopPropagation()})),l.off("change"),l.on("change",(function(){t.$currentItems.each((function(e,t){o(t).attr("hidden","")})),l.prop("checked")&&a.removeAttr("hidden"),t.updateState()})),l.parent().unbind("keypress"),l.parent().on("keypress",(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),o(e.target).parent().trigger("click"))})),l.parent().off("click"),l.parent().on("click",(function(){e.collapse(e.$widget,e.$trigger,e.$target)}))}))}},{key:"connect",value:function(){this.multi?this.$currentItems.each(this.connectMulti()):this.connectSingle()}},{key:"currentLi",value:function(e,t,n,i,a,r){if(e&&!n)return o('<li class="none-selected">blank</li>');var l=o("<li "+(r?"":"hidden")+' data-list-item="'+(n?t+"_"+n:t+"__blank")+'" class="'+(n?"":"current__blank")+'"><span class="widget-value__value"></span><button type="button" class="close select-widget-value__delete" aria-hidden="true" aria-label="delete" title="delete" tabindex="-1">&times</button></li>');return l.data("list-text",i),l.data("list-id",n),l.find("span").html(a),l}},{key:"availableLi",value:function(e,t,n,i,a,r){if(this.multi&&!n)return null;var l=n?t+"_"+n:t+"__blank",s=n?"answer":"answer answer--blank",c=' <div class="details"><button type="button" class="btn btn-small btn-default btn-js-more-info" data-record-id="'+n+'" aria-describedby="lbl-'+l+'" data-target="'+this.el.data("details-modal")+'" data-toggle="modal">Details</button></div>',u=o('<li class="'+s+'"><div class="control"><div class="'+(e?"checkbox":"radio-group__option")+'"><input id="'+l+'" type="'+(e?"checkbox":"radio")+'" name="'+t+'" '+(r?" checked":"")+(this.required&&!this.multi?' required aria-required="true"':"")+' value="'+(n||"")+'" class="'+(e?"":"visually-hidden")+'" aria-labelledby="lbl-'+l+'"> <label id="lbl-'+l+'" for="'+l+'">'+a+"</label></div></div>"+(n?c:"")+"</li>");return u.data("list-text",i),u.data("list-id",n),u}},{key:"updateJson",value:function(e,t){var i=this;this.loadCounter++;var r=this,l=this.loadCounter;this.$available.find(".spinner").removeAttr("hidden");var s=this.$available.find("input:checked").map((function(){return parseInt(o(this).val())})).get();t||this.$available.find(".answer").remove();var c=this.$selectWidget.data("field"),u=!0;o.getJSON(e,(function(e){if(0===e.error){if(l!=i.loadCounter)return void(u=!1);t?i.$currentItems.filter(":hidden").remove():i.$currentItems.remove();var a=s.includes(NaN);i.multi&&(i.$search.parent().prevAll(".none-selected").remove(),i.$search.parent().before(i.currentLi(i.multi,c,null,"","blank",a)),i.$available.append(i.availableLi(i.multi,c,null,"","blank",a))),o.each(e.records,(function(e,n){var a=s.includes(n.id);(!t||t&&!a)&&(i.$search.parent().before(i.currentLi(i.multi,c,n.id,n.label,n.html,a)).before(" "),i.$available.append(i.availableLi(i.multi,c,n.id,n.label,n.html,a)))})),i.$currentItems=i.$current.find("[data-list-item]"),i.$available=i.$selectWidget.find(".available"),i.$availableItems=i.$selectWidget.find(".available .answer input"),i.$moreInfoButtons=i.$selectWidget.find(".available .answer .btn-js-more-info"),i.$answers=i.$selectWidget.find(".answer"),i.updateState(),i.connect(),i.$availableItems.on("blur",(function(e){i.possibleCloseWidget(e)})),i.$moreInfoButtons.on("blur",(function(e){i.possibleCloseWidget(e)})),i.$moreInfoButtons.each((function(e,t){n.e(998).then(n.bind(n,38697)).then((function(e){new(0,e.default)(t)}))}))}else{var r=1===e.error?e.message:"Oops! Something went wrong.",d=o('<li class="answer answer--blank alert alert-danger d-flex flex-row justify-content-start"><span class="control"><label>'+r+"</label></span></li>");i.$available.append(d)}})).fail((function(t,n,i){a.m.error("Failed to make request to "+e+": "+n+": "+i);var l=o('<li class="answer answer--blank alert alert-danger"><span class="control"><label>Oops! Something went wrong.</label></span></li>');r.$available.append(l)})).always((function(){u&&r.$available.find(".spinner").attr("hidden","")}))}},{key:"fetchOptions",value:function(){var e=this.$selectWidget.data("filter-endpoint"),t=this.$selectWidget.data("filter-fields"),n=this.$selectWidget.data("submission-token");if(!Array.isArray(t))throw"Invalid data-filter-fields found. It should be a proper JSON array of fields.";var i=["submission-token="+n];o.each(t,(function(e,t){o("input[name="+t+"]").each((function(e,n){var a=o(n);switch(a.attr("type")){case"number":case"text":case"hidden":i.push(t+"="+a.val());break;case"radio":case"checkbox":n.checked&&i.push(t+"="+a.val())}}))}));var a=i.join("&");this.lastFetchParams!==a&&(this.lastFetchParams=null,this.updateJson(e+"?"+a),this.lastFetchParams=a)}},{key:"expand",value:function(e,t,n){if("true"!==t.attr("aria-expanded")){if(this.$selectWidget.addClass("select-widget--open"),this.$available.find(".spinner").attr("hidden",""),t.attr("aria-expanded",!0),this.$selectWidget.data("filter-endpoint")&&this.$selectWidget.data("filter-endpoint").length)try{this.fetchOptions()}catch(e){a.m.error(e)}var i=e.offset().top,r=i+e.outerHeight(),l=o(window).scrollTop(),s=l+o(window).height()-60,c=i-200>l&&!(r+200<s);n.toggleClass("available--top",c),n.removeAttr("hidden"),this.$search.get(0)!==document.activeElement&&this.$search.focus()}}}])&&s(i.prototype,l),c&&s(i,c),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,l,c}(i.uA)},11977:(e,t,n)=>{n.d(t,{m:()=>o});n(52675),n(89463),n(2259),n(45700),n(23792),n(89572),n(2892),n(26099),n(99449),n(47764),n(62953);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function r(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}var o=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.allowLogging="localhost"===location.hostname||"127.0.0.1"===location.hostname||location.hostname.endsWith(".peek.digitpaint.nl")},(t=[{key:"log",value:function(e){this.allowLogging&&console.log(e)}},{key:"info",value:function(e){this.allowLogging&&console.info(e)}},{key:"warn",value:function(e){this.allowLogging&&console.warn(e)}},{key:"error",value:function(e){this.allowLogging&&console.error(e)}}])&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}())},74423:(e,t,n)=>{var i=n(46518),a=n(19617).includes,r=n(79039),o=n(6469);i({target:"Array",proto:!0,forced:r((function(){return!Array(1).includes()}))},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},99449:(e,t,n)=>{var i,a=n(46518),r=n(27476),o=n(77347).f,l=n(18014),s=n(655),c=n(60511),u=n(67750),d=n(41436),h=n(96395),f=r("".endsWith),p=r("".slice),g=Math.min,b=d("endsWith");a({target:"String",proto:!0,forced:!!(h||b||(i=o(String.prototype,"endsWith"),!i||i.writable))&&!b},{endsWith:function(e){var t=s(u(this));c(e);var n=arguments.length>1?arguments[1]:void 0,i=t.length,a=void 0===n?i:g(l(n),i),r=s(e);return f?f(t,r,a):p(t,a-r.length,a)===r}})},21699:(e,t,n)=>{var i=n(46518),a=n(79504),r=n(60511),o=n(67750),l=n(655),s=n(41436),c=a("".indexOf);i({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~c(l(o(this)),l(r(e)),arguments.length>1?arguments[1]:void 0)}})}}]);