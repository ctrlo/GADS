"use strict";(self.webpackChunklinkspace=self.webpackChunklinkspace||[]).push([[249,384],{39992:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});a(752),a(60228),a(21694),a(76265),a(79307),a(64043),a(61514),a(78730),a(12826),a(57267),a(2918),a(89730),a(25728),a(73964),a(268),a(6203),a(32320),a(34338),a(28436),a(34284),a(47522),a(46946),a(69358),a(69373),a(59903),a(59749),a(86544),a(79288),a(88052),a(76034),a(30050),a(84254);var n=a(53865),r=(a(30991),a(78336),a(31443),a(783),a(29358),a(29312),a(42438)),o=a(33099),i=a(66223),l=a(19755);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=h(e);if(t){var r=h(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return function(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,a)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function b(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}const p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(g,e);var t,h,p,v=u(g);function g(e){var t,a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),t=v.call(this,e),a=f(t),r=function(e){e.preventDefault();var a="#"+t.el.attr("id"),n=t.el.data("transferDestination"),r=l(e.target).closest("tr");(0,i.transferRowToTable)(r,a,n)},(n=b(n="transferRow"))in a?Object.defineProperty(a,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[n]=r,t.el=l(t.element),t.hasCheckboxes=t.el.hasClass("table-selectable"),t.hasClearState=t.el.hasClass("table-clear-state"),t.forceButtons=t.el.hasClass("table-force-buttons"),t.searchParams=new URLSearchParams(window.location.search),t.base_url=t.el.data("href")?t.el.data("href"):void 0,t.isFullScreen=!1,t.initTable(),t}return t=g,h=[{key:"initTable",value:function(){var e=this;if(this.hasClearState){this.clearTableStateForPage();var t=new URL(window.location.href);t.searchParams.delete("table_clear_state");var n=t.toString();window.location.replace(n.endsWith("?")?n.slice(0,-1):n)}else{var o=this.getConf(),i=o.columns;this.columns=i,this.el.DataTable(o),this.initializingTable=!0,this.hasCheckboxes&&this.addSelectAllCheckbox(),this.el.hasClass("table-account-requests")&&(this.modal=l.find("#userModal"),this.initClickableTable(),this.el.on("draw.dt",(function(){e.initClickableTable()}))),this.bindTransferTableClickHandlers(),l(this.el).on("childRow.dt",(function(e,t,n){var o=l(n.child()),i=o.find(".record-popup");(0,r.D)(o),i&&a.e(152).then(a.bind(a,21526)).then((function(e){var t=e.default;i.each((function(e,a){new t(a)}))}))}))}}},{key:"clearTableStateForPage",value:function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);if(t.startsWith("DataTables")){var a=t.split("/");!a||a.length<=1||-1!==window.location.href.indexOf("/"+a.slice(1).join("/"))&&localStorage.removeItem(t)}}}},{key:"initClickableTable",value:function(){var e=this,t=this.el.find("tbody td .link");t.off("click"),t.off("focus"),t.off("blur"),t.on("click",(function(t){e.handleClick(t)})),t.on("focus",(function(t){e.toggleFocus(t,!0)})),t.on("blur",(function(t){e.toggleFocus(t,!1)}))}},{key:"toggleFocus",value:function(e,t){var a=l(e.target).closest("tr");t?a.addClass("tr--focus"):a.removeClass("tr--focus")}},{key:"handleClick",value:function(e){var t=l(e.target).closest("tr");e.preventDefault(),this.fillModalData(t),l(this.modal).modal("show")}},{key:"fillModalData",value:function(e){var t=l(this.modal).find("input, textarea"),a=l(this.modal).find(".btn-js-reject-request"),n=parseInt(l(e).find("td[data-id]").data("id"),10);n&&(l(this.modal).data("config").id=n),a&&n&&!isNaN(n)&&a.val(n),t.each((function(t,a){var n=l(a).attr("name"),r=l(e).find("td[data-".concat(n,"]")).data(n);if(n&&r){var o=l(a);o.data("original-value",r),o.is(":radio, :checkbox")?o.val()==r&&o.trigger("click"):(o.data("original-value",r),o.trigger("change"),o.val(r))}}))}},{key:"getCheckboxElement",value:function(e,t){return"<div class='checkbox'>"+"<input id='dt_checkbox_".concat(e,"' type='checkbox' />")+"<label for='dt_checkbox_".concat(e,"'><span>").concat(t,"</span></label>")+"</div>"}},{key:"addSelectAllCheckbox",value:function(){var e=this,t=this.el.find("thead th.check"),a=this.el.find("tbody .check .checkbox input");t.length&&t.html(this.getCheckboxElement("all","Select all")),this.checkSelectAll(a,t.find("input")),a.on("click",(function(){e.checkSelectAll(a,t.find("input"))})),t.find("input").on("click",(function(t){var n=l(t.target);l(n).is(":checked")?e.checkAllCheckboxes(a,!0):e.checkAllCheckboxes(a,!1)}))}},{key:"checkAllCheckboxes",value:function(e,t){t?e.prop("checked",!0):e.prop("checked",!1)}},{key:"checkSelectAll",value:function(e,t){var a=!0;e.each((function(e,n){n.checked||(t.prop("checked",!1),a=!1)})),a&&t.prop("checked",!0)}},{key:"addSortButton",value:function(e,t,a){var n=l(t.header()),r=l('\n      <button class="data-table__sort" type="button">\n        <span>'.concat(a,'</span>\n        <span class="btn btn-sort">\n          <span>Sort</span>\n        </span>\n      </button>'));n.off().find(".data-table__header-wrapper").html(r),e.order.listener(r,t.index())}},{key:"toggleFilter",value:function(e){var t=l(e.header());""!==e.search()?(t.find(".data-table__header-wrapper").addClass("filter"),t.find(".data-table__clear").show()):(t.find(".data-table__header-wrapper").removeClass("filter"),t.find(".data-table__clear").hide())}},{key:"addSearchDropdown",value:function(e,t,n){var r=this,o=l(e.header()),i=o.text().trim(),c=e.search(),s=this,d=e.context[0].oAjaxData.columns[e.index()].name,u=this.columns[e.index()],f=l("<div class='data-table__search'>\n        <button\n          class='btn btn-search dropdown-toggle'\n          id='search-toggle-".concat(n,"'\n          type='button'\n          data-toggle='dropdown'\n          aria-expanded='false'\n          data-boundary='viewport'\n          data-reference='parent'\n          data-target=\"[data-ddl='ddl_").concat(n,"']\"\n          data-focus=\"[data-ddl='ddl_").concat(n,"']\"\n        >\n          <span>Search in ").concat(i,"</span>\n        </button>\n        <div class='dropdown-menu p-2' aria-labelledby='search-toggle-").concat(n,"'>\n          <label>\n            <div class='input'>\n            </div>\n          </label>\n          <button type='button' class='btn btn-link btn-small data-table__clear hidden'>\n            <span>Clear filter</span>\n          </button>\n        </div>\n      </div>")),h=l("<input class='form-control form-control-sm' type='text' placeholder='Search' value='".concat(c,"'/>"));h.appendTo(l(".input",f)),u.typeahead_use_id?(h.after('<input type="hidden" class="search">'),l.ajax({type:"GET",url:this.getApiEndpoint(d)+c+"&use_id=1",dataType:"json"}).done((function(e){e.error||h.val(e.records[0].label)}))):l("input",f).addClass("search"),o.find(".data-table__header-wrapper").prepend(f),this.toggleFilter(e),u&&u.typeahead&&Promise.all([a.e(608),a.e(353)]).then(a.bind(a,75198)).then((function(e){(new(0,e.default)).withAjaxSource(r.getApiEndpoint(d)).withInput(l("input",o)).withAppendQuery().withDefaultMapper().withName(d.replace(/\s+/g,"")+"Search").withCallback((function(e){l("input",o).val(e.name),l("input",o).trigger("change")})).build()})),l("input.search",o).on("change",(function(a){var n=this.value||a.target.value;e.search()!==n&&e.search(n).draw(),s.toggleFilter(e),s.searchParams.has(t)?s.searchParams.set(t,this.value):s.searchParams.append(t,this.value);var r="".concat(window.location.href.split("?")[0],"?").concat(s.searchParams.toString());window.history.replaceState(null,"",r)})),l(".data-table__clear",o).on("click",(function(){if(l(this).closest(".dropdown-menu").find("input").val(""),e.search("").draw(),s.toggleFilter(e),s.searchParams.has(t)){s.searchParams.delete(t);var a="".concat(window.location.href.split("?")[0]);void 0!==s.searchParams.entries().next().value&&(a+="?".concat(s.searchParams.toString())),window.history.replaceState(null,"",a)}}))}},{key:"getApiEndpoint",value:function(e){var t=l("body").data("layout-identifier");return"/".concat(t,"/match/layout/").concat(e,"?q=")}},{key:"encodeHTMLEntities",value:function(e){return l("<textarea/>").text(e).html()}},{key:"decodeHTMLEntities",value:function(e){return l("<textarea/>").html(e).text()}},{key:"renderMoreLess",value:function(e,t){return e.toString().length>50?'<div class="more-less" data-column="'.concat(t,'">\n          ').concat(e,"\n        </div>"):e}},{key:"renderDefault",value:function(e){var t=this,a="";return e.values&&e.values.length?(e.values.forEach((function(n,r){a+=t.encodeHTMLEntities(n),a+=e.values.length>r+1?", ":""})),this.renderMoreLess(a,e.name)):a}},{key:"renderId",value:function(e){var t="",a=e.values[0];return a?(e.parent_id&&(t='<span title="Child record with parent record '.concat(e.parent_id,'">').concat(e.parent_id," &#8594;</span> ")),t+'<a href="'.concat(this.base_url,"/").concat(a,'">').concat(a,"</a>")):t}},{key:"renderPerson",value:function(e){var t=this,a="";return e.values.length?(e.values.forEach((function(e){if(e.details.length){var n="<div>";e.details.forEach((function(e){var a=t.encodeHTMLEntities(e.value);"email"===e.type?n+='<p>E-mail: <a href="mailto:'.concat(a,'">').concat(a,"</a></p>"):n+="<p>".concat(t.encodeHTMLEntities(e.definition),": ").concat(a,"</p>")})),n+="</div>",a+='<div class="position-relative">\n            <button class="btn btn-small btn-inverted btn-info trigger" aria-expanded="false" type="button">\n              '.concat(t.encodeHTMLEntities(e.text),'\n              <span class="invisible">contact details</span>\n            </button>\n            <div class="person contact-details expandable popover card card--secundary">\n              ').concat(n,"\n            </div>\n          </div>")}})),a):a}},{key:"renderFile",value:function(e){var t=this,a="";return e.values.length?(e.values.forEach((function(e){a+='<a href="/file/'.concat(e.id,'">'),e.mimetype.match("^image/")?a+='<img class="autosize" src="/file/'.concat(e.id,'"></img>'):a+="".concat(t.encodeHTMLEntities(e.name),"<br>"),a+="</a>"})),a):a}},{key:"renderRag",value:function(e){var t="";t=e.values.length&&{a_grey:"undefined",b_red:"danger",b_attention:"attention",c_amber:"warning",c_yellow:"advisory",d_green:"success",d_blue:"complete",e_purple:"unexpected"}[e.values[0]]||"blank";var a=l("#rag_"+t+"_meaning").text();return'<span class="rag rag--'.concat(t,'" title="').concat(a,'" aria-labelledby="rag_').concat(t,'_meaning"><span>âœ—</span></span>')}},{key:"renderCurCommon",value:function(e){var t="";return 0===e.values.length?t:(t=this.renderCurCommonTable(e),this.renderMoreLess(t,e.name))}},{key:"renderCurCommonTable",value:function(e){var t=this,a="";return 0===e.values.length||0===e.values[0].fields.length||(a+='<table class="table-curcommon">',e.values.forEach((function(e){a+='<tr role="button" tabindex="0" class="link record-popup" data-record-id="'.concat(e.record_id,'"'),e.version_id&&(a+='data-version-id="'.concat(e.version_id,'"')),a+=">",e.status&&(a+="<td><em>".concat(e.status,":</em></td>")),e.fields.forEach((function(e){a+='<td class="'.concat(e.type,'">').concat(t.renderDataType(e),"</td>")})),a+="</tr>"})),a+="</table>",e.limit_rows&&e.values.length>=e.limit_rows&&(a+="<p><em>(showing maximum ".concat(e.limit_rows,' rows.\n          <a href="/').concat(e.parent_layout_identifier,"/data?curval_record_id=").concat(e.curval_record_id,"&curval_layout_id=").concat(e.column_id,'">view all</a>)</em>\n        </p>'))),a}},{key:"renderDataType",value:function(e){switch(e.type){case"id":return this.renderId(e);case"person":case"createdby":return this.renderPerson(e);case"curval":case"autocur":case"filval":return this.renderCurCommon(e);case"file":return this.renderFile(e);case"rag":return this.renderRag(e);default:return this.renderDefault(e)}}},{key:"renderData",value:function(e,t,a){var n=t[a?a.settings.oAjaxData.columns[a.col].name:""];return"object"!==c(n)?"":this.renderDataType(n)}},{key:"getConf",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=this.el.data("config"),n={};if("string"==typeof a?n=JSON.parse(atob(a)):"object"===c(a)&&(n=a),t)for(var r in t)n[r]=t[r];return n.serverSide&&n.columns.forEach((function(t){t.render=function(t,a,n,r){return e.renderData(a,n,r)}})),n.initComplete=function(t,a){var r=e.el,o=r.DataTable();e.json=a||void 0;var i=e;e.initializingTable&&(o.columns().every((function(e){var a=this,c=l(a.header()),s=c.html();if(c.html("<div class='data-table__header-wrapper position-relative ".concat(a.search()?"filter":"","' data-ddl='ddl_").concat(e,"'>").concat(s,"</div>")),c.hasClass("sorting")&&i.addSortButton(o,a,s),n.serverSide&&r.hasClass("table-search")){var d=t.oAjaxData.columns[e].name;i.searchParams.has(d)&&a.search(i.searchParams.get(d)).draw(),i.addSearchDropdown(a,d,e)}return!0})),e.el.hasClass("collapsed")||e.el.closest(".dataTables_wrapper").find(".btn-toggle-off").length&&e.el.closest(".dataTables_wrapper").find(".dataTables_toggle_full_width").hide(),e.initializingTable=!1)},n.footerCallback=function(){var e=this.api(),t=e.ajax&&e.ajax.json()&&e.ajax.json().aggregate;if(t){var a=e.settings()[0].oAjaxData.columns;e.columns().every((function(){var e=this.index(),n=a[e].name;return t[n]&&l(this.footer()).html(self.renderDataType(t[n])),!0}))}},n.drawCallback=function(){o.W.reinitialize(),e.el.DataTable().button(0).enable(),e.bindClickHandlersAfterDraw(n)},n.buttons=[{text:"Full screen",enabled:!1,attr:{id:"full-screen-btn"},className:"btn btn-small btn-toggle-off",action:function(t){e.toggleFullScreenMode(t)}}],n}},{key:"toggleFullScreenMode",value:function(e){var t=this,a=document.querySelector("table.data-table"),n=l(a);if(n&&l.fn.dataTable.isDataTable(n)&&n.DataTable().destroy(),this.isFullScreen){var r=document.querySelector(".content-block__main-content");if(!r)return void console.warn("Failed to close full screen; missing main content");r.appendChild(a),n&&!l.fn.dataTable.isDataTable(n)&&n.DataTable(this.getConf()),document.querySelector("#table-modal").remove(),l(document).off("keyup")}else{var o=document.createElement("div");o.id="table-modal",o.classList.add("table-modal"),o.classList.add("data-table__container--scrollable"),o.append(a),n&&!l.fn.dataTable.isDataTable(n)&&n.DataTable(this.getConf({responsive:!1})),document.body.appendChild(o),l(document).on("keyup",(function(a){"Escape"===a.key&&t.toggleFullScreenMode(e)}))}this.isFullScreen=!this.isFullScreen,l("#full-screen-btn").removeClass(this.isFullScreen?"btn-toggle-off":"btn-toggle"),l("#full-screen-btn").addClass(this.isFullScreen?"btn-toggle":"btn-toggle-off")}},{key:"bindClickHandlersAfterDraw",value:function(e){var t=this,a=this.el,o=a.DataTable().rows({page:"current"}).data();if(o&&this.base_url&&l(a).find("> tbody > tr").each((function(e,a){var n=o[e]?o[e]:void 0;if(n){var r=n._id?"".concat(t.base_url,"/").concat(n._id):"?".concat(n._count.url);l(a).find('td:not(".dtr-control")').on("click",(function(e){e.target.closest(".record-popup")||(window.location=r)}))}})),e.serverSide){var i=l(a).find(":not(.more-less) > .trigger[aria-expanded]");i.off("click",r.T),i.on("click",r.T),(0,n.ez)(this.element)}this.bindTransferTableClickHandlers()}},{key:"bindTransferTableClickHandlers",value:function(){if(this.el.hasClass("table-transfer")){var e=this.el.find("tbody tr");e.off("click",this.transferRow),e.on("click",this.transferRow);var t=this.el.find("tbody btn");t.off("click",this.transferRow),t.on("click",this.transferRow)}}}],h&&s(t.prototype,h),p&&s(t,p),Object.defineProperty(t,"prototype",{writable:!1}),g}(n.wA)},66223:(e,t,a)=>{a.r(t),a.d(t,{addRow:()=>r,clearTable:()=>i,getRowOrder:()=>c,transferRowToTable:()=>s,updateRow:()=>o});a(25728),a(60228),a(32320);var n=a(19755),r=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?l(e,t):t.DataTable().row.add(e).draw()},o=function(e,t,a){t.find("tbody > tr").each((function(r,o){n(o).has("button[data-tempid=".concat(a,"]")).length&&t.DataTable().row(r).data(e).draw()}))},i=function(e){e.DataTable().clear().draw()},l=function(e,t){var a=t.DataTable();a.row.add(e).draw("page");for(var n=a.data().length-1,r=a.row(n),o=c(r),i=n;i>0;i--){var l=(r=a.row(i)).data(),s=a.row(i-1);if(c(s)<o)break;a.row(i).data(s.data()),a.row(i-1).data(l)}a.page(a.page()).draw(!1)},c=function(e){try{var t=n(e.node()).find("input").first().data("order");return void 0===t?-1:parseInt(t)}catch(e){return-1}},s=function(e,t,a){if(void 0!==t){var o=n(t),i=e.find("input").first();if(0===i.length&&console.error("Failed to move row from table '".concat(t,"'; missing checkbox input element")),i.attr("checked",!i.prop("checked")),void 0!==a){var l=n(a),s=o.DataTable().row(e),d=c(s)>-1;d||console.warn("Failed to move row to correct position in '".concat(a,"'; missing data-order attribute in checkbox input element")),s.invalidate(),r(s.data(),l,d),s.remove().draw("page")}else console.error("Failed to move row; missing 'transfer-destination' data attribute for table '".concat(t,"'"))}else console.error("Failed to move row; missing sourceTableID")}}}]);