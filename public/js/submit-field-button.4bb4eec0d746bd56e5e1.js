"use strict";(self.webpackChunklinkspace=self.webpackChunklinkspace||[]).push([[841],{59892:(e,t,i)=>{i.r(t),i.d(t,{default:()=>n});i(91460),i(55668),i(99893);var l=i(74692);class n{constructor(e){this.errored=!1,e.on("click",(e=>{const t=l("#field_type_tree"),i=l("#tree-config .tree-widget-container"),n=l("#calcfield_card_header"),r=l("#displayConditionsBuilder"),s=r.length&&r.queryBuilder("getRules"),o=l(".people-filter"),a=o.length&&o.queryBuilder("getRules"),d=l("#displayConditions"),c=l("#refers_to_instance_id"),f=c.length&&l(`[data-builder-id='${c.val()}']`),u=l("#default_field_permissions_table");let p=!1,g=!1,h=!1,w=!1;const _=l("#show_in_edit");if(n.length&&n.is(":visible")&&!_.val()){if(!this.errored){const e=document.createElement("div");e.classList.add("form-text","form-text--error"),e.innerHTML="Please select the calculation field visibility before submitting the form",_.closest(".form-group").append(e),e.scrollIntoView(),this.errored=!0}e.preventDefault()}if((t.length&&t.is(":visible")&&i.length||!t.length&&i.length)&&(p=!0),c.length&&!c.prop("disabled")&&f.length&&(g=!0),s&&d.length&&(h=!0),o.length&&a&&(w=!0),p){const e=i.jstree(!0).get_json("#",{flat:!1}),t=JSON.stringify(e),n=i.data();l.ajax({async:!1,type:"POST",url:this.getURL(n),data:{data:t,csrf_token:n.csrfToken}}).done((()=>{alert("Tree has been updated")}))}g&&window.UpdateFilter&&window.UpdateFilter(f,e),w&&window.UpdatePeopleFilter&&window.UpdatePeopleFilter(o,e),h&&d.val(JSON.stringify(s,null,2));const b=u.DataTable().$("input,select,textarea");b.hide();const m=l(e.currentTarget).closest("form");u.remove(),m.append(b)}))}getURL(e){if(window.test)return"";const t=window.siteConfig&&window.siteConfig.urls.treeApi;return t||`/${e.layoutIdentifier}/tree/${e.columnId}`}}}}]);