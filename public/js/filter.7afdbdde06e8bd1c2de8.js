(self.webpackChunklinkspace=self.webpackChunklinkspace||[]).push([["filter"],{"./src/frontend/components/form-group/filter/lib/component.js":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.array.find.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.json.stringify.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.symbol.to-primitive.js"),r("./node_modules/core-js/modules/es.date.to-primitive.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/es.object.get-prototype-of.js"),r("./node_modules/core-js/modules/es.reflect.to-string-tag.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.object.keys.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js");var o=r("./src/frontend/js/lib/component.js"),n=(r("./node_modules/@lol768/jquery-querybuilder-no-eval/dist/js/query-builder.standalone.min.js"),r("./node_modules/jquery-typeahead/dist/jquery.typeahead.min.js"),r("./src/frontend/js/lib/logging.js")),s=r("./node_modules/jquery/dist/jquery.js"),l=r("./node_modules/buffer/index.js").Buffer;function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,m(o.key),o)}}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f(e);if(t){var n=f(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}(this,r)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function y(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==i(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}const j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,r,o,i=d(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),y(p(t=i.call(this,e)),"buildFilter",(function(e,r){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:r.filterId,label:r.label,type:"string",operators:t.buildFilterOperators(r.type)},"rag"===r.type?t.ragProperties:r.hasFilterTypeahead?t.typeaheadProperties(r.urlSuffix,e.layoutId,r.instanceId,r.useIdInFilter):{})})),y(p(t),"typeaheadProperties",(function(e,t,r,o){return{input:function(e,t){return"<div class='typeahead__container'>\n          <input class='form-control typeahead_text' type='text' name='".concat(t,"_text'/>\n          <input class='form-control typeahead_hidden' type='hidden' name='").concat(t,"'/>\n        </div>")},valueSetter:function(e,t){e.$el.find(".typeahead_hidden").val(t),e.$el.find(".typeahead_text").val(e.data.text)},validation:{callback:function(){return!0}}}})),y(p(t),"getRecords",(function(e,r,o,n){return s.ajax({type:"GET",url:t.getURL(e,r),data:{q:n,oi:o},dataType:"json",path:"records"})})),t.el=s(t.element),t.operators=[{type:"equal",accept_values:!0,apply_to:["string","number","datetime"]},{type:"not_equal",accept_values:!0,apply_to:["string","number","datetime"]},{type:"less",accept_values:!0,apply_to:["string","number","datetime"]},{type:"less_or_equal",accept_values:!0,apply_to:["string","number","datetime"]},{type:"greater",accept_values:!0,apply_to:["string","number","datetime"]},{type:"greater_or_equal",accept_values:!0,apply_to:["string","number","datetime"]},{type:"contains",accept_values:!0,apply_to:["datetime","string"]},{type:"not_contains",accept_values:!0,apply_to:["datetime","string"]},{type:"begins_with",accept_values:!0,apply_to:["string"]},{type:"not_begins_with",accept_values:!0,apply_to:["string"]},{type:"is_empty",accept_values:!1,apply_to:["string","number","datetime"]},{type:"is_not_empty",accept_values:!1,apply_to:["string","number","datetime"]},{type:"changed_after",nb_inputs:1,accept_values:!0,multiple:!1,apply_to:["string","number","datetime"]}],t.ragProperties={input:"select",values:{b_red:"Red",c_amber:"Amber",c_yellow:"Yellow",d_green:"Green",a_grey:"Grey",e_purple:"Purple"}},t.initFilter(),t}return t=f,(r=[{key:"initFilter",value:function(){var e=this,t=this,r=this.el,o=s(this.el).data("builder-id"),i=s("#builder_json_".concat(o));if(i.length){var a=JSON.parse(i.html()),u=r.data("filter-base");if(a.filters.length&&(a.filterNotDone&&this.makeUpdateFilter(),r.queryBuilder({showPreviousValues:a.showPreviousValues,filters:a.filters.map((function(t){return e.buildFilter(a,t)})),allow_empty:!0,operators:this.operators,lang:{operators:{changed_after:"changed on or after"}}}),r.on("validationError.queryBuilder",(function(e,t,r,o){n.logging.log(r),n.logging.log(o),n.logging.log(e),n.logging.log(t)})),r.on("afterCreateRuleInput.queryBuilder",(function(e,r){var o;if(a.filters.forEach((function(e){if(e.filterId===r.filter.id)return o=e,!1})),o&&"rag"!==o.type&&o.hasFilterTypeahead){var n=s("#".concat(r.id," .rule-value-container input[type='text']")),l=s("#".concat(r.id," .rule-value-container input[type='hidden']"));n.attr("autocomplete","off"),n.on("keyup",(function(){l.val(n.val())})),n.typeahead({delay:100,dynamic:!0,minLength:1,offset:!0,order:"asc",matcher:function(){return!0},callback:{onClickAfter:function(e,t,r,n){o.useIdInFilter?l.val(r.id):l.val(r.label),l.trigger("change")},onCancel:function(){l.val("")}},source:{record:{display:"label",ajax:function(e){return{type:"GET",url:t.getURL(a.layoutId,o.urlSuffix),data:{q:e,oi:o.instanceId},dataType:"json",path:"records"}}}}})}})),u)){var c=l.from(u,"base64");try{var d=JSON.parse(c);d.rules&&d.rules.length?r.queryBuilder("setRules",d):r.queryBuilder("setRules",{rules:[]})}catch(e){n.logging.log("Incorrect data object passed to queryBuilder")}}}}},{key:"getURL",value:function(e,t){var r=window.siteConfig&&window.siteConfig.urls.filterApi;return r||"/".concat(e,"/match/layout/").concat(t)}},{key:"makeUpdateFilter",value:function(e){window.UpdateFilter=function(e,t){e.queryBuilder("validate")||t.preventDefault();var r=e.queryBuilder("getRules");s("#filter").val(JSON.stringify(r,null,2))}}},{key:"buildFilterOperators",value:function(e){if(["date","daterange"].includes(e)){var t=["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_empty","is_not_empty"];return"daterange"===e&&t.push("contain"),t}}}])&&u(t.prototype,r),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),f}(o.Component)},"./node_modules/core-js/modules/es.object.get-own-property-descriptors.js":(e,t,r)=>{var o=r("./node_modules/core-js/internals/export.js"),n=r("./node_modules/core-js/internals/descriptors.js"),s=r("./node_modules/core-js/internals/own-keys.js"),l=r("./node_modules/core-js/internals/to-indexed-object.js"),i=r("./node_modules/core-js/internals/object-get-own-property-descriptor.js"),a=r("./node_modules/core-js/internals/create-property.js");o({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(e){for(var t,r,o=l(e),n=i.f,u=s(o),c={},d=0;u.length>d;)void 0!==(r=n(o,t=u[d++]))&&a(c,t,r);return c}})},"./node_modules/core-js/modules/es.object.keys.js":(e,t,r)=>{var o=r("./node_modules/core-js/internals/export.js"),n=r("./node_modules/core-js/internals/to-object.js"),s=r("./node_modules/core-js/internals/object-keys.js");o({target:"Object",stat:!0,forced:r("./node_modules/core-js/internals/fails.js")((function(){s(1)}))},{keys:function(e){return s(n(e))}})}}]);
//# sourceMappingURL=filter.7afdbdde06e8bd1c2de8.js.map