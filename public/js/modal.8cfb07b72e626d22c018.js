"use strict";(self.webpackChunklinkspace=self.webpackChunklinkspace||[]).push([[42,776],{73538:(t,e,i)=>{i.r(e),i.d(e,{default:()=>h});var s=i(17527),a=i(56197),n=i(74692);const d="select__placeholder",l="select__menu-item--active",r="select__menu-item--hover";class o extends s.uA{constructor(t){super(t),this.el=n(this.element),this.toggleButton=this.el.find(".select__toggle"),this.input=this.el.find("input"),this.menu=this.el.find(".select__menu"),this.options=this.el.find(".select__menu-item"),this.optionChecked="",this.optionHoveredIndex=-1,this.optionsCount=this.options.length,this.isSelectReveal=this.el.hasClass("select--reveal"),this.initSelect(this.el),this.el.hasClass("select--required")&&(0,a.pT)(this.el)}static self=this;initSelect(){this.options&&(this.options.on("click",(t=>{this.handleClick(t)})),this.input.on("change",(t=>{this.handleChange(t)})),this.el.on("show.bs.dropdown",(()=>{this.handleOpen()})),this.input.val()&&this.input.trigger("change"))}addOption(t,e){const i=document.createElement("li");i.classList.add("select__menu-item"),i.setAttribute("role","option"),i.setAttribute("aria-selected","false"),i.setAttribute("data-id",t),i.setAttribute("data-value",e),i.innerHTML=t,this.menu.append(i),this.bindOptionHandler(i),this.options=this.el.find(".select__menu-item")}removeOption(t){this.options.each(((e,i)=>{parseInt(i.dataset.value)===t&&i.remove()}))}updateOption(t,e){this.options.each(((i,s)=>{parseInt(s.dataset.value)===e&&(s.setAttribute("data-id",t),s.innerHTML=t)}))}bindOptionHandler(t){n(t).on("click",(t=>{this.handleClick(t)}))}handleOpen(){this.el.on("keydown",(t=>{this.supportKeyboardNavigation(t)}))}handleClose(t){this.el.dropdown("hide"),t.stopPropagation(),this.el.off("keydown")}handleChange(t){const e=n(t.target).val();""===e?this.resetSelect():this.options.each(((t,i)=>{n(i).data("value").toString()===e&&(this.updateChecked(n(i)),this.isSelectReveal&&this.revealInstance(n(i)))}))}handleClick(t){const e=n(t.target),i=e.data("value"),s=e.data("reveal_id");this.input.val(i).trigger("change"),void 0!==s&&this.input.attr("data-reveal_id",s),this.updateChecked(n(e)),this.isSelectReveal&&this.revealInstance(n(e)),this.toggleButton.trigger("focus")}revealInstance(t){const e=n(`.select-reveal--${this.input.attr("id")} > .select-reveal__instance`);let i="";i=void 0!==t.data("reveal_id")?`#${this.input.attr("id")}_${t.data("reveal_id")}`:`#${this.input.attr("id")}_${t.data("value")}`,e.each(((t,e)=>{n(e).hide(),this.disableFields(e,!0)})),n(i).show(),this.disableFields(n(i),!1)}disableFields(t,e){const i=n(t).find("input, textarea");e?i.prop("disabled",!0):i.removeAttr("disabled")}updateHovered(t){const e=this.options[this.optionHoveredIndex],i=this.options[t];e&&e.classList.remove(r),i&&i.classList.add(r),this.optionHoveredIndex=t}updateChecked(t){const e=n(t).data("value"),i=n(t).html();this.toggleButton.find("span").html(i),this.toggleButton.find("span").removeClass(d),this.options.removeClass(l),this.options.attr("aria-selected",!1),n(t).addClass(l),n(t).attr("aria-selected",!0),this.optionChecked=e}supportKeyboardNavigation(t){if(40===t.keyCode&&this.optionHoveredIndex<this.optionsCount-1&&(t.preventDefault(),this.updateHovered(this.optionHoveredIndex+1)),38===t.keyCode&&this.optionHoveredIndex>0&&(t.preventDefault(),this.updateHovered(this.optionHoveredIndex-1)),13===t.keyCode||32===t.keyCode){t.preventDefault();const e=this.options[this.optionHoveredIndex],i=e&&n(e).data("value");i&&this.input.val(i).trigger("change"),this.handleClose(t)}27===t.keyCode&&this.handleClose(t)}resetSelect(){const t=this.input[0].placeholder;this.toggleButton.find("span").html(t),this.toggleButton.find("span").addClass(d),this.options.removeClass(l),this.options.attr("aria-selected",!1),this.input.removeAttr("value"),this.input.removeAttr("data-restore-value")}}const h=o},28817:(t,e,i)=>{i.d(e,{A:()=>o});var s=i(17527),a=i(97468);class n{constructor(t,e){this.object=t,this.step=t.data("config").step,this.number=t.data("config").frame,this.item=t.data("config").item||null,this.skip=t.data("config").skip||null,this.back=e,this.requiredFields=t.find("input[required]"),this.isValid=!0,this.error=[],this.buttons={next:t.find(".modal-footer .btn-js-next"),back:t.find(".modal-footer .btn-js-back"),skip:t.find(".modal-footer .btn-js-skip"),addNext:t.find(".modal-footer .btn-js-add-next"),invisible:t.find(".modal-footer .btn-js-add-next"),save:t.find(".modal-footer .btn-js-save")}}}var d=i(11977),l=i(74692);class r extends s.uA{static get allowReinitialization(){return!0}constructor(t){super(t),this.el=l(this.element),this.isWizzard=this.el.hasClass("modal--wizzard"),this.isForm=this.el.hasClass("modal--form"),this.frames=this.el.find(".modal-frame"),this.typingTimer=null,this.wasInitialized||this.initModal()}initModal(){this.el.on("show.bs.modal",(()=>{if(a.y.addSubscriber(this),this.isWizzard){try{this.activateFrame(1,0)}catch(t){d.m.error(t),this.preventModalToOpen()}this.el.on("hide.bs.modal",(t=>{this.dataHasChanged()&&(confirm("Are you sure you want to close this popup? Any unsaved data will be lost.")||t.preventDefault())}))}(this.isWizzard||this.isForm)&&this.el.on("hidden.bs.modal",(()=>{this.el.off("hide.bs.modal"),a.y.close()})),this.hideContent(!0)}))}dataHasChanged(){const t=l(this.el).find("input, textarea");let e=!1;return t.each(((t,i)=>{if(l(i).val())if("hidden"!==l(i).attr("type")&&"checkbox"!==l(i).attr("type")&&"radio"!==l(i).attr("type")||"hidden"===l(i).attr("type")&&l(i).parents(".select").length){if(l(i).data("original-value")&&l(i).val().toString()!==l(i).data("original-value").toString()||!l(i).data("original-value"))return e=!0,!1}else if("hidden"!==l(i).attr("type")&&(l(i).data("original-value")&&l(i).prop("checked")&&l(i).val()!==l(i).data("original-value").toString()||!l(i).data("original-value")&&l(i).prop("checked")))return e=!0,!1})),e}hideContent(t){t?l("body").children().attr("aria-hidden",!0):l("body").children().removeAttr("aria-hidden")}preventModalToOpen(){const t=this.el.attr("id")||"";l(`.btn[data-target="#${t}"]`).on("click",(function(t){t.stopPropagation()}))}clearFields(t){l(t).find("input, textarea").each(((t,e)=>{const i=l(e);"radio"===i.attr("type")?i.prop("checked",!1):"checkbox"===i.attr("type")?i.is(":checked")&&i.trigger("click"):(i.data("restore-value")?i.val(i.data("restore-value")):i.val(""),l(e).removeData("original-value"),i.trigger("change")),i.is(":invalid")&&(i.attr("aria-invalid",!1),i.closest(".input").removeClass("input--invalid"))}))}clearFrames(t){t?l(t).each(((t,e)=>{const i=this.getFrameByNumber(e);i&&this.clearFields(i)})):this.frames.each(((t,e)=>{this.clearFields(e)}))}getFrameNumber(t){const e=l(t).data("config");if(e.frame&&!isNaN(e.frame))return e.frame}getFrameByNumber(t){let e=null;return this.frames.each(((i,s)=>{if(l(s).data("config").frame===t)return e=s,!1})),e}activateFrame(t,e,i){this.frames.each(((s,a)=>{const n=l(a).data("config");if(!n.frame||isNaN(n.frame))throw"activateFrame: frame is not a number!";if(this.unbindEventHandlers(l(a)),n.frame===t){try{this.frame=this.createFrame(a,e)}catch(t){d.m.error(t)}this.frame.object.removeClass("invisible"),this.frame.object.find(".alert").hide(),this.activateStep(this.frame.step),this.bindEventHandlers(),this.frame.requiredFields.length&&(this.frame.buttons.next&&this.setNextButtonState(!1),this.frame.buttons.invisible&&this.setInvisibleButtonState(!1)),i&&(this.clearFields(a),this.validateFrame())}else l(a).addClass("invisible")}))}createFrame(t,e){if(isNaN(l(t).data("config").step)||isNaN(l(t).data("config").frame))throw"createFrame: Parameter is not a number!";if(l(t).data("config").skip&&isNaN(l(t).data("config").skip))throw"createFrame: Skip parameter is not a number!";return new n(l(t),e)}bindEventHandlers(){this.frame.buttons.next.click((()=>{a.y.next(this.frame.object)})),this.frame.buttons.back.click((()=>{a.y.back(this.frame.object)})),this.frame.buttons.skip.click((()=>{this.frame.skip&&a.y.skip(this.frame.skip)})),this.frame.buttons.addNext.click((()=>{a.y.add(this.frame.object)})),this.frame.buttons.save.click((()=>{a.y.save()})),this.frame.requiredFields.bind("keyup.modalEvent",(t=>{this.handleKeyup(t)})),this.frame.requiredFields.bind("keydown.modalEvent",(()=>{this.handleKeydown()})),this.frame.requiredFields.bind("blur.modalEvent",(t=>{this.handleBlur(t)}))}handleKeyup(t){const e=t.target;clearTimeout(this.typingTimer),this.typingTimer=setTimeout((()=>{l(e).val()&&this.validateField(e)}),1e3)}handleKeydown(){clearTimeout(this.typingTimer)}handleBlur(t){const e=t.target;clearTimeout(this.typingTimer),l(e).val()&&this.validateField(e)}isValidField(t){return!l(t).is(":invalid")&&""!=l(t).val()}validateField(t){const e=this.isValidField(t);if(this.frame.error=[],!e){const e=l(t).closest(".input").find("label").html();this.frame.error.push(`${e} is invalid`)}this.setInputState(l(t),e),this.validateFrame()}validateFrame(){this.frame.isValid=!0,this.frame.requiredFields.each(((t,e)=>{this.isValidField(l(e))||(this.frame.isValid=!1)})),this.setFrameState()}setInputState(t){t.is(":invalid")?(t.attr("aria-invalid",!0),t.closest(".input").addClass("input--invalid")):(t.attr("aria-invalid",!1),t.closest(".input").removeClass("input--invalid"))}setFrameState(){const t=this.frame.object.find(".alert");if(this.frame.buttons.next&&this.setNextButtonState(this.frame.isValid),this.frame.buttons.invisible&&this.setInvisibleButtonState(this.frame.isValid),!this.frame.isValid&&this.frame.error.length>0){const e="<p>There were problems with the following fields:</p>";let i="";l.each(this.frame.error,((t,e)=>{const s=l("<span>").text(e).html();i+=`<li>${s}</li>`})),t.html(`<div>${e}<ul>${i}</ul></div>`),t.show(),this.el.animate({scrollTop:t.offset().top},500)}else t.hide()}unbindEventHandlers(t){t.find(".modal-footer .btn").unbind(),t.find("input[required]").unbind(".modalEvent")}setNextButtonState(t){t?(this.frame.buttons.next.removeAttr("disabled"),this.frame.buttons.next.removeClass("btn-disabled"),this.frame.buttons.next.addClass("btn-default")):(this.frame.buttons.next.attr("disabled","disabled"),this.frame.buttons.next.addClass("btn-disabled"),this.frame.buttons.next.removeClass("btn-default"))}setInvisibleButtonState(t){t?this.frame.buttons.invisible.removeClass("btn-invisible"):this.frame.buttons.invisible.addClass("btn-invisible")}activateStep(t){this.el.find(".modal__step").each(((e,i)=>{l(i).data("step")===t?l(i).addClass("modal__step--active"):l(i).removeClass("modal__step--active")}))}handleUpload(t){const e=this,i=this.el.data("config").url,s=this.el.data("config").id,a=l("body").data("csrf").toString();t.csrf_token=a||"";const n=JSON.stringify(t),d=s?`${i}/${s}`:i;l.ajax({method:"POST",contentType:"application/json",url:d,data:n,processData:!1}).done((function(){location.reload()})).fail((function(t){const i=t.responseJSON.message;e.showError(i)}))}showError(t){const e=this.frame.object.find(".alert"),i=l("<span>").text(t).html();e.html(`<p>Error: ${i}</p>`),e.show(),this.el.animate({scrollTop:e.offset().top},500)}handleNext(){const t=this.frame.number+1;this.frames.length>=t&&this.activateFrame(t,this.frame.number)}handleBack(){this.frame.back>0&&this.activateFrame(this.frame.back,this.frame.back-1),this.validateFrame()}handleSkip(t){this.activateFrame(t,this.frame.number)}handleAdd(t){a.y.update(t),this.clearFields(t),this.validateFrame()}handleActivate(t,e){this.activateFrame(t,this.frame.number,e)}handleShow(t){l(t).modal("show")}handleClear(t){this.clearFrames(t)}handleValidate(){this.validateFrame()}handleClose(){this.clearFrames(),this.isWizzard&&(this.activateFrame(1,0,!0),this.el.data("config")&&this.el.data("config").id&&(this.el.data("config").id=null)),this.el.unbind("hide.bs.modal hidden.bs.modal"),a.y.unsubscribe(this)}}const o=r},97468:(t,e,i)=>{i.d(e,{y:()=>s});const s=new class{constructor(){this.observers=[]}addSubscriber(t){this.observers.push(t)}unsubscribe(t){var e=this.observers.indexOf(t);this.observers.splice(e,1)}activate(t,e,i){this.observers.forEach((s=>s.handleActivate?.(t,e,i)))}add(t){this.observers.forEach((e=>e.handleAdd?.(t)))}back(t){this.observers.forEach((e=>e.handleBack?.(t)))}next(t){this.observers.forEach((e=>e.handleNext?.(t)))}show(t){this.observers.forEach((e=>e.handleShow?.(t)))}save(){this.observers.forEach((t=>t.handleSave?.()))}upload(t){this.observers.forEach((e=>e.handleUpload?.(t)))}clear(t){this.observers.forEach((e=>e.handleClear?.(t)))}close(){this.observers.forEach((t=>t.handleClose?.()))}skip(t){this.observers.forEach((e=>e.handleSkip?.(t)))}validate(){this.observers.forEach((t=>t.handleValidate?.()))}update(t){this.observers.forEach((e=>e.handleUpdate?.(t)))}}},83208:(t,e,i)=>{i.r(e),i.d(e,{default:()=>p});var s=i(28817),a=i(74692);const n=(t,e)=>{e.DataTable().row.add(t).draw()},d=(t,e,i)=>{e.find("tbody > tr").each(((s,n)=>{a(n).has(`button[data-tempid=${i}]`).length&&e.DataTable().row(s).data(t).draw()}))},l=t=>{t.DataTable().clear().draw()};var r=i(97468),o=i(73538),h=i(74692);class c extends s.A{constructor(t){super(t),this.el=h(this.element),this.json={},this.fieldOptions=this.el.find(".modal-body .field-options"),this.topicsTable=this.el.find("#topics"),this.fieldsTable=this.el.find("#fields"),this.selectTopic=this.el.find(".modal-body .select--js-topic")[0],this.selectTopicComponent=new o.default(this.selectTopic),this.currentFieldObject={},this.currentTopicObject={},this.initNewTable(this.el)}initNewTable(){const t=this.el.find(".modal-body .btn-js-create-topic"),e=this.el.find(".modal-body .btn-js-create-field");t.on("click",(()=>{r.y.activate(4,!0)})),e.on("click",(()=>{r.y.activate(7,!0)})),this.fieldOptions.addClass("hidden"),this.setupDataObject()}setupDataObject(){this.json={table_permissions:[],topics:[],fields:[]}}addFieldsToObject(t,e){return t.each(((t,i)=>{h(i).val()&&("checkbox"==h(i).prop("type")?h(i).prop("checked")?e[h(i).attr("name")]=!0:e[h(i).attr("name")]=!1:"topic_tempid"===h(i).attr("name")?e[h(i).attr("name")]=parseInt(h(i).val()):e[h(i).attr("name")]=h(i).val())})),e}addTopic(t){const e=t.find("input, textarea");if(0===Object.keys(this.currentTopicObject).length){let t={tempId:this.uniqueID()};t=this.addFieldsToObject(e,t),this.currentTopicObject=t,this.json.topics.push(t),this.selectTopicComponent.addOption(t.name,t.tempId);const i=[`<button class="btn btn-link btn-js-edit-topic" type="button" data-tempid="${t.tempId}">${t.name}</button>`,t.description||"",t.expanded,""];n(i,this.topicsTable),this.addHandlerToEditItemButton("topic")}else{const t=this.json.topics.find((t=>t.tempId===this.currentTopicObject.tempId));e.each(((e,i)=>{h(i).val()&&(t[h(i).attr("name")]=h(i).val())}));const i=[`<button class="btn btn-link btn-js-edit-topic" type="button" data-tempid="${this.currentTopicObject.tempId}">${this.currentTopicObject.name}</button>`,this.currentTopicObject.description||"",this.currentTopicObject.expanded,""];d(i,this.topicsTable,this.currentTopicObject.tempId),this.selectTopicComponent.updateOption(this.currentTopicObject.name,this.currentTopicObject.tempId),this.addHandlerToEditItemButton("topic")}}fillFields(t,e){for(const[i,s]of Object.entries(e)){const e=t.find(`[name=${i}]`);e&&("checkbox"===e.prop("type")&&!0===s?e.prop("checked",!0):"hidden"===e.prop("type")?(e.val(s),e.trigger("change")):(e.val(s),e.trigger("blur")))}}editTopic(t,e){this.currentTopicObject=t,this.fillFields(h(e),t)}editField(t,e){this.currentFieldObject=t,r.y.clear([8,9]),this.fillFields(h(e),t);const i=t.field_type,s=super.getFrameByNumber(8),a=h(s).find(`[id=field_type_${i}]`);this.fillFields(a,t.field_type_settings);const n=t.custom_field_permissions,d=super.getFrameByNumber(9);n.forEach((t=>{const e=t.group_id,i=h(d).find(`tr[data-group-id=${e}]`);this.fillFields(i,t.permissions)}))}removeNode(t,e){return e.filter((e=>e.tempId!==t))}addHandlerToEditItemButton(t){const e=this.el.find(`.modal-body .btn-js-edit-${t}`);e.off("click");const i="topic"===t?4:7;e.each(((t,e)=>{const s=h(e).data("tempid");h(e).on("click",(()=>{r.y.activate(i,!0,s)}))}))}uniqueID(){return Math.floor(Math.random()*Date.now())}addField(t){const e=t.find("input, textarea");if(0===Object.keys(this.currentFieldObject).length){let t={tempId:this.uniqueID(),custom_field_permissions:[],field_type_settings:{}};t=this.addFieldsToObject(e,t),this.currentFieldObject=t,this.json.fields.push(t);const i=[`<button class="btn btn-link btn-js-edit-field" type="button" data-tempid="${t.tempId}">${t.name}</button>`,t.name,t.topic||"",t["field-type"],""];n(i,this.fieldsTable),this.addHandlerToEditItemButton("field")}else{const t=this.json.fields.find((t=>t.tempId===this.currentFieldObject.tempId));e.each(((e,i)=>{h(i).val()&&(t[h(i).attr("name")]=h(i).val())}));const i=[`<button class="btn btn-link btn-js-edit-field" type="button" data-tempid="${this.currentFieldObject.tempId}">${this.currentFieldObject.name}</button>`,this.currentFieldObject.name,this.currentFieldObject.topic||"",this.currentFieldObject["field-type"],""];d(i,this.fieldsTable,this.currentFieldObject.tempId),this.addHandlerToEditItemButton("field")}}addFieldTypeSettings(t){const e=t.find("[id^=field_type_].select-reveal__instance:visible"),i=e.find("input, textarea"),s=this.json.fields.find((t=>t.tempId===this.currentFieldObject.tempId));switch(e.attr("id")){case"field_type_enum":{const t=e.find('input[name="ordering"]'),i=e.find(".sortable input");let a={dropdown_values:[],ordering:t.val()};i.each(((t,e)=>{let i={};i[h(e).attr("name")]=h(e).val(),a.dropdown_values.push(i)})),s.field_type_settings=a;break}case"field_type_tree":{const t=e.find(".tree-widget-container");let a={data:{},dataJson:{}};if(t.length){const e=t.jstree(!0).get_json("#",{flat:!1}),i=(JSON.stringify(e),t.data().jstree._model.data);a.data=i,a.dataJson=e}a=this.addFieldsToObject(i,a),s.field_type_settings=a;break}case"field_type_curval":{const t=e.find('input[name="curval_field_ids"]:visible'),i=e.find('input:not([name="curval_field_ids"]), textarea');let a={curval_field_ids:[]};t.each(((t,e)=>{h(e).val()&&a.curval_field_ids.push(h(e).val())})),a=this.addFieldsToObject(i,a),s.field_type_settings=a;break}default:{let t={};t=this.addFieldsToObject(i,t),s.field_type_settings=t}}}addTable(t){const e=t.find("input, textarea"),i=this.el.find(".modal-title");e.each(((t,e)=>{h(e).val()&&(this.json[h(e).attr("name")]=h(e).val())})),this.json.name&&i.html(`Table setup | ${this.json.name}`)}addCustomFieldPermissions(t){const e=t.find("#custom_field_permissions_table").DataTable().rows(),i=this.json.fields.find((t=>t.tempId===this.currentFieldObject.tempId));i.custom_field_permissions=[],e.every((()=>{const t=this.nodes()[0],e=t.dataset.groupId,s=h(t).find("td")[0].innerHTML.trim(),a=h(t).find("input");let n={group_id:e,group_name:s,permissions:{}};n.permissions=this.addFieldsToObject(a,n.permissions),i.custom_field_permissions.push(n)}))}addTablePermissions(t){t.find(".card--expandable").each(((t,e)=>{const i=h(e).closest(".permission-group"),s=i&&void 0!==i.data("group-id")?i.data("group-id"):"",a=h(e).find(".card__subtitle")[0].innerHTML.trim(),n=h(e).find("fieldset");let d={group_id:s,group_name:a,records:{},views:{},fields:{}};n.each(((t,e)=>{const i=h(e).data("name"),s=h(e).find("input");d[i]=this.addFieldsToObject(s,d[i])})),this.json.table_permissions.push(d)}))}handleNext(t){switch(super.handleNext(),t.data("config").item){case"topic":this.addTopic(t);break;case"field":this.addField(t);break;case"field type settings":this.addFieldTypeSettings(t),this.recalculateDatatableColumnWidths(h("#custom_field_permissions_table"));break;case"custom field permissions":this.addCustomFieldPermissions(t);break;case"table":this.addTable(t);break;case"table permissions":this.addTablePermissions(t);break;default:{const e=t.find("input, textarea");this.addFieldsToObject(e,this.json)}}}recalculateDatatableColumnWidths(t){t.DataTable().columns.adjust()}handleBack(){super.handleBack()}handleSave(){r.y.upload(this.json)}handleUpdate(t){"topic"===t.data("config").item?(this.addTopic(t),this.currentTopicObject={}):"field"===t.data("config").item&&(this.addField(t),this.currentFieldObject={})}handleActivate(t,e,i){if(super.handleActivate(t,e),7===t&&i){const e=super.getFrameByNumber(t),s=this.json.fields.find((t=>t.tempId===i));this.editField(s,e)}else if(7===t&&e)this.currentFieldObject={},r.y.clear([8,9]);else if(4===t&&i){const e=super.getFrameByNumber(t),s=this.json.topics.find((t=>t.tempId===i));this.editTopic(s,e)}else 4===t&&e&&(this.currentTopicObject={});super.validateFrame()}handleClose(){this.el.find(".collapse").collapse("hide"),this.topicsTable&&l(this.topicsTable),this.fieldsTable&&l(this.fieldsTable),this.selectTopicComponent.options.each(((t,e)=>{this.selectTopicComponent.removeOption(parseInt(e.dataset.value))})),this.setupDataObject(),this.currentFieldObject={},this.currentTopicObject={},super.handleClose()}}const p=c},50349:(t,e,i)=>{i.r(e),i.d(e,{default:()=>l});var s=i(97468),a=i(28817),n=i(74692);class d extends a.A{constructor(t){super(t),this.el=n(this.element),this.emailField=this.el.find('input[name="email"]'),this.emailText=this.el.find(".js-email"),this.initUserModal()}initUserModal(){this.el.on("show.bs.modal",(t=>{this.toggleContent(t),s.y.validate(),this.updateEmail(),this.emailField.keyup((()=>{this.updateEmail()}))}))}toggleContent(t){n(t.relatedTarget).hasClass("btn-add")?(s.y.clear(),this.el.find(".js-approve-account").hide(),this.el.find(".js-add-user").show(),this.el.find(".btn-js-reject-request").hide(),this.el.find(".btn-js-save .btn__title").html("Create account"),this.el.find('input[name="approve-account"]').val("false")):(this.el.find(".js-add-user").hide(),this.el.find(".js-approve-account").show(),this.el.find(".btn-js-reject-request").show(),this.el.find(".btn-js-save .btn__title").html("Approve account"),this.el.find('input[name="approve-account"]').val("true"))}updateEmail(){this.emailText.html(this.emailField.val())}getData(){const t={view_limits:[],permissions:[],groups:[]};return this.el.find("input, textarea").each(((e,i)=>{if("radio"===n(i).prop("type")||"checkbox"===n(i).prop("type")){if(n(i).prop("checked")){const e=isNaN(n(i).val())?n(i).val():parseInt(n(i).val());Array.isArray(t[n(i).attr("name")])?t[n(i).attr("name")].push(e):t[n(i).attr("name")]=e}}else if(""!==n(i).val()){const e=n(i).val(),s=isNaN(e)?this.parseValue(e):parseInt(e);Array.isArray(t[n(i).attr("name")])?t[n(i).attr("name")].push(s):t[n(i).attr("name")]=s}})),t}parseValue(t){return"true"===t||"false"!==t&&t}handleSave(){s.y.upload(this.getData())}handleClose(){super.handleClose(),this.emailText.html("USER")}}const l=d}}]);